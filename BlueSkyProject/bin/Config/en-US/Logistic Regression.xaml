<BSkyCanvas internalhelpfilename="{x:Null}" Title="Logistic Regression" ModelClasses="{x:Null}" StatusTextBoxName="{x:Null}" customsyntax="{x:Null}" EditableComboBoxName="{x:Null}" RPackages="pscl" CanExecute="True" PrereqCommandString="{x:Null}" CommandString="#Builds a logistic model with default name logistic1&#xA;&#xA;{{modelname}}= glm({{dependent}} ~ {{independent}}, weights={{destination2}}, family =binomial(link='logit'), data={{%DATASET%}})&#xA;&#xA;local(&#xA;{&#xA;if(!is.null( {{modelname}} ) )&#xA;{&#xA;#Summarizing the model&#xA;BSky_Logistic = summary({{modelname}})&#xA;BSkyFormat(BSky_Logistic, singleTableOutputHeader=&quot;Model Summary&quot;)&#xA;&#xA;#Analysis of variance&#xA;BSky_anova = anova({{modelname}}, test=&quot;Chisq&quot;)&#xA;BSkyFormat(as.data.frame(BSky_anova),singleTableOutputHeader=&quot;Analysis of Deviance Table&quot;)&#xA;&#xA;#McFadden R2&#xA;BSkyFormat( pR2({{modelname}}) ,singleTableOutputHeader=&quot;McFadden R2&quot;)&#xA;&#xA;}&#xA;&#xA;}&#xA;)&#xA;&#xA;&#xA;&#xA;" dlgsyntax="#Builds a logistic model with default name logistic1&#xA;&#xA;{{modelname}}= glm({{dependent}} ~ {{independent}}, weights={{destination2}}, family =binomial(link='logit'), data={{%DATASET%}})&#xA;&#xA;local(&#xA;{&#xA;if(!is.null( {{modelname}} ) )&#xA;{&#xA;#Summarizing the model&#xA;BSky_Logistic = summary({{modelname}})&#xA;BSkyFormat(BSky_Logistic, singleTableOutputHeader=&quot;Model Summary&quot;)&#xA;&#xA;#Analysis of variance&#xA;BSky_anova = anova({{modelname}}, test=&quot;Chisq&quot;)&#xA;BSkyFormat(as.data.frame(BSky_anova),singleTableOutputHeader=&quot;Analysis of Deviance Table&quot;)&#xA;&#xA;#McFadden R2&#xA;BSkyFormat( pR2({{modelname}}) ,singleTableOutputHeader=&quot;McFadden R2&quot;)&#xA;&#xA;}&#xA;&#xA;}&#xA;)&#xA;&#xA;&#xA;&#xA;" Helpfile="{x:Null}" splitProcessing="True" MenuLocation="{x:Null}" OutputDefinition="{x:Null}" Width="560" Command="False" Height="480" HelpText="&lt;html&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;.c0 { color: Black } .c1 { margin: 0px 0px 10px } .c2 { color: Black; background-color: White; line-height: 1.15; font-size: 14.6666666666667px; font-family: 'Arial' } .c3 { margin: 0px 0px 13px; line-height: 1.15; font-size: 14.6666666666667px; font-family: 'Calibri','Trebuchet MS' } .c4 { font-weight: bold; font-family: 'Arial'; font-size: 14.6666666666667px } .c5 { margin: 0px; line-height: normal; font-size: 14.6666666666667px; font-family: 'Calibri','Trebuchet MS' } .c6 { font-family: 'Arial' } .c7 { margin: 0px 0px 10px; line-height: 1.15; font-size: 14.6666666666667px; font-family: 'Calibri','Trebuchet MS' } .c8 { font-family: 'Arial'; font-size: 14.6666666666667px } &lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c0&quot;&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&lt;span class=&quot;c2&quot;&gt;Builds a binary logistic regression model. We use glm function passing the parameter family =binomial(link='logit'). We display a summary of the model, analysis of variance tables and McFadden R2.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&lt;span class=&quot;c2&quot;&gt;You can score the model by selecting the model created on the top right hand corner of the main application screen and select the Score button. You can select to display a confusion matrix and a ROC curve&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&lt;span class=&quot;c2&quot;&gt;The default model name is Logistic1 which you can change.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c3&quot;&gt;&lt;span&gt;&lt;span class=&quot;c4&quot;&gt;Usage:&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c5&quot;&gt;&lt;span&gt;&lt;span class=&quot;c6&quot;&gt;modelname &amp;lt;- glm(dependentVariable ~ var1+var2+var3...,family =binomial(link='logit'),data=datasetName)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c3&quot;&gt;&lt;span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;depVar: Name of the dependent variable. &amp;#160;If we have a dataset cars, with a variable class that we want to predict (dependent variable is class) enter class&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c3&quot;&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;indepVars: Names of the independent variable, separated by +. If we have a dataset cars, with independent &amp;#160;variable horsepower, enginesize, specify horsepower+enginesize). Categorical variables are automatically dummy coded.&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c3&quot;&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;data: Name of the dataframe. When you open data frames or datasets e.g. csv, Excel files, SAS files in BlueSky Statistics, they are named Dataset1, Dataset2, Dataset3 So enter data=Dataset1&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c3&quot;&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c4&quot;&gt;Package: &amp;#160;stats&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span&gt;&lt;span class=&quot;c6&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c4&quot;&gt;Other:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;Click the R Help button to get detailed R help&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span&gt;&lt;span class=&quot;c6&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c4&quot;&gt;References:&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;&amp;#160;https://datascienceplus.com/perform-logistic-regression-in-r/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;https://www.machinelearningplus.com/machine-learning/logistic-regression-tutorial-examples-r/&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;" RHelpText="help(glm, package='stats')" Background="#FFFFFFFF" xmlns="clr-namespace:BSky.Controls;assembly=BSky.Controls" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BSkySourceList CanExecute="True" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" Name="source" AutoVar="False" renderVars="False" Filter="String|Numeric|Date|Logical|Ordinal|Nominal|Scale" Width="252" Height="447" Left="6" Top="26" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="6" av:Canvas.Top="26" av:Grid.IsSharedSizeScope="True"><BSkySourceList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkySourceList.SelectionChangeBehaviour><BSkySourceList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkySourceList.Template><BSkySourceList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkySourceList.Style></BSkySourceList><BSkyTargetList CanExecute="False" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="" SepCharacter="+" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseSeperator" ordlevels="" nomlevels="" Name="independent" AutoVar="True" renderVars="False" Filter="String|Numeric|Logical|Ordinal|Nominal|Scale" Width="250" Height="254" Left="297" Top="151" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="297" av:Canvas.Top="151" av:Grid.IsSharedSizeScope="True"><BSkyTargetList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="independent" PropertyName="CanExecute" Value="false" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="GreaterThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="independent" PropertyName="CanExecute" Value="true" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTargetList.SelectionChangeBehaviour><BSkyTargetList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkyTargetList.Template><BSkyTargetList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTargetList.Style></BSkyTargetList><BSkyGroupingVariable Name="dependent" Width="250" Height="31" Left="297" Top="85" Filter="Numeric|Date|Logical|Ordinal|Nominal|Scale" CanExecute="False" SubstituteSettings="NoPrefix|UseComma" Enabled="True" PrefixTxt="" SepCharacter="" nomlevels="" ordlevels="" Syntax="%%VALUE%%" IsEnabled="True" av:Canvas.Left="297" av:Canvas.Top="85"><BSkyGroupingVariable.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependent" PropertyName="CanExecute" Value="false" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependent" PropertyName="CanExecute" Value="true" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyGroupingVariable.SelectionChangeBehaviour><SingleItemList CanExecute="False" summaryCtrl="False" PrefixTxt="" SepCharacter="" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" AutoVar="True" renderVars="False" Filter="Numeric|Date|Logical|Ordinal|Nominal|Scale" Left="NaN" Top="NaN" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AllowDrop="True" Focusable="True" av:Grid.IsSharedSizeScope="True"><SingleItemList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependent" PropertyName="CanExecute" Value="false" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependent" PropertyName="CanExecute" Value="true" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></SingleItemList.SelectionChangeBehaviour><SingleItemList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></SingleItemList.Template><SingleItemList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></SingleItemList.Style></SingleItemList></BSkyGroupingVariable><BSkyTargetList CanExecute="True" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="1" SubstituteSettings="NoPrefix|UseComma" ordlevels="{x:Null}" nomlevels="{x:Null}" Name="destination2" AutoVar="True" renderVars="False" Filter="String|Numeric|Date|Logical|Ordinal|Nominal|Scale" Width="250" Height="33" Left="297" Top="440" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="297" av:Canvas.Top="440" av:Grid.IsSharedSizeScope="True"><BSkyTargetList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyTargetList.SelectionChangeBehaviour><BSkyTargetList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkyTargetList.Template><BSkyTargetList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTargetList.Style></BSkyTargetList><BSkyLabel Name="label2" Text="Dependent Variable (one)" Width="160" Height="25" Left="293" Top="61" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="293" av:Canvas.Top="61">Dependent Variable (one)</BSkyLabel><BSkyLabel Name="label1" Text="Source Variables" Width="111" Height="23" Left="3" Top="3.01980662698043E-14" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="3.01980662698043E-14">Source Variables</BSkyLabel><BSkyVariableMoveButton Name="move1" InputList="source" TargetList="independent" Width="30" Height="30" Left="261" Top="149" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="261" av:Canvas.Top="149"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyVariableMoveButton Name="move2" InputList="source" TargetList="dependent" Width="30" Height="30" Left="260" Top="83" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="260" av:Canvas.Top="83"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyLabel Name="label3" Text="Independent Variable (one or more)" Width="209" Height="25" Left="294" Top="125" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="294" av:Canvas.Top="125">Independent Variable (one or more)</BSkyLabel><BSkyLabel Name="l11" Text="Enter Model Name" Width="199" Height="23" Left="291" Top="2" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="291" av:Canvas.Top="2">Enter Model Name</BSkyLabel><BSkyTextBox PrefixTxt="{x:Null}" OverWriteExistingVariables="False" OverwriteSettings="DontPrompt" Name="modelname" Width="250" Height="30" Left="297" Top="27" SubstituteSettings="TextAsIs" CanExecute="True" Enabled="True" Syntax="%%VALUE%%" TextWrapping="Wrap" AcceptsTab="True" VerticalScrollBarVisibility="Auto" FontFamily="Segoe UI" FontSize="12" VerticalContentAlignment="Center" Template="{av:DynamicResource TextBoxBaseControlTemplate}" AllowDrop="True" IsEnabled="True" av:Canvas.Left="297" av:Canvas.Top="27"><BSkyTextBox.TextChangedBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="isNullOrEmpty" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="modelname" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="ValidString" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="modelname" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTextBox.TextChangedBehaviour><BSkyTextBox.Style><av:Style TargetType="av:TextBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTextBox.Style>Logistic1</BSkyTextBox><BSkyLabel Name="lbl1" Text="Weights (optional)" Width="129" Height="26" Left="295" Top="412" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="295" av:Canvas.Top="412">Weights (optional)</BSkyLabel><BSkyVariableMoveButton Name="moveWt" InputList="source" TargetList="destination2" Width="30" Height="30" Left="261" Top="438" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="261" av:Canvas.Top="438"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyLabelReqdField Name="rq1" Text="*" Width="15" Height="25" Left="432" Top="58" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="432" av:Canvas.Top="58">*</BSkyLabelReqdField><BSkyLabelReqdField Name="rq2" Text="*" Width="15" Height="25" Left="486" Top="122" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="486" av:Canvas.Top="122">*</BSkyLabelReqdField></BSkyCanvas>